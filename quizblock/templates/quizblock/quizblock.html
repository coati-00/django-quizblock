<link href="/activity/quiz/media/css/quizblock.css" rel="stylesheet" type="text/css" />
<script src="/activity/quiz/media/js/quizblock.js" type="text/javascript"></script>

<script type="text/javascript">
    jQuery(document).ready(function() {
        if (!hasMultipleVideos() && !hasSingleVideo()) {
            loadState({{block.id}}, {{block.pageblock.id}});
        }
        
        jQuery(":input").change(function(index) {
            if (!hasMultipleVideos() && !hasSingleVideo()) {
                storeState(jQuery(this));
            } 
        });
    });
</script>

{% if block.question_has_video %}
    {% include "quizblock/singlevideoquizblock.html" %}
{% else %} {% if block.answers_have_video %}
    {% include "quizblock/multivideoquizblock.html" %}
{% else %}

{% load markup %}
{% load getresponse %}

{{ block.description|markdown }}

{% for question in block.question_set.all %}
{% getquestionresponse question as response %}

<div class="cases">
     {{question.intro_text|markdown}}

     <div class="casetitle"> Question {{question.display_number|add:"1"}}:</div>
     
     <div class="casecontent">
           <div class="casequestion">
                 {{question.text|markdown}}

		 {% if question.answerable %}
		 {% if block.rhetorical %}
                 <form id="form-{{question.id}}" method="post" action="{{request.get_full_path}}">
		 {% endif %}
                 <div id='question-{{question.display_number|add:"1"}}'>
                       <ol type="A">
			 {% for answer in question.answer_set.all %}
			 {% if block.rhetorical %}
			   {% if question.is_single_choice %}
                             <li><input name="pageblock-{{block.pageblock.id}}-question{{question.id}}" value="{{answer.value}}" type="radio" />{{answer.label}}</li>
			   {% else %}
                             <li><input name="pageblock-{{block.pageblock.id}}-question{{question.id}}" value="{{answer.value}}" type="checkbox" />{{answer.label}}</li>
			   {% endif %}
			 {% else %}
			    {% if question.is_single_choice %}
<li>
{% if response %}
{% ifequal response.value answer.value %}
<span class="yours {% if response.is_correct %}correct{% else %}incorrect{% endif %}">{{answer.label}}</span>
{% else %}
{{answer.label}}
{% endifequal %}
{% else %}
<input name="pageblock-{{block.pageblock.id}}-question{{question.id}}" value="{{answer.value}}" type="radio" />{{answer.label}}{% endif %}
</li>
			    {% else %}

<li>

{% if response %}

{% comment %}

multi select is trickier. since there can be more than one correct
response and more than one response by the user.

{% endcomment %}

{% ifanswerin response answer  %}
   <span class="yours {% if answer.correct %}correct correctanswer{% else %}incorrect incorrectanswer{% endif %}">{{answer.label}}</span>
{% else %}
   <span class="{% if answer.correct %}correct{% else %}incorrect{% endif %}">{{answer.label}}</span>
{% endifanswerin %}

{% else %}
{% comment %}no response{% endcomment %}
   <input name="pageblock-{{block.pageblock.id}}-question{{question.id}}" value="{{answer.value}}" type="checkbox" />{{answer.label}}
{% endif %}</li>
			    {% endif %}
			 {% endif %}
			 {% endfor %}
                      </ol>
                 {% if block.rhetorical %}
                    </div>
                 </form>
		 {% endif %}
		 {% else %}

		 {% if question.is_short_text %}
  		   {% if block.rhetorical %}
		     <input type="text" name="question{{question.id}}" />
		   {% else %}
{% if response %}
<p class="yours">{{response.value|markdown}}</p>
{% else %}
<input type="text" name="pageblock-{{block.pageblock.id}}-question{{question.id}}" />
{% endif %}
		   {% endif %}
		 {% endif %}

		 {% if question.is_long_text %}
  		   {% if block.rhetorical %}
		     <textarea rows="10" name="question{{question.id}}" ></textarea>
		   {% else %}
{% if response %}
<p class="yours">{{response.value|markdown}}</p>
{% else %}
		     <textarea rows="10" name="pageblock-{{block.pageblock.id}}-question{{question.id}}" ></textarea>
{% endif %}
		   {% endif %}
		 {% endif %}



		 {% endif %}
           </div>
	   {% if question.answerable %}
	   {% if block.rhetorical %}
	   {% if question.is_single_choice %}
           <div class="casesanswerdisplay">
                 <div id="q{{question.id}}" style="display:none" class="answer">
                 <p>{% if question.correct_answer_letter %}<b>The
                 correct answer is
                 {{question.correct_answer_letter}}:</b>{% endif %} {{question.explanation|markdown}}</p>
                 </div>
           </div>
	   {% endif %}
	   {% if question.is_multiple_choice %}
	   <div class="casesanswerdisplay">
                 <a href="#q{{question.id}}" class="moretoggle">Show answer(s) &gt;&gt;</a>
                 <div id="q{{question.id}}" class="toggleable">
                 <p><i>The correct answer(s):</i></p>
		   <ol type="A">
		     {% for answer in question.answer_set.all %}
		     <li>{% if answer.correct %}
		       <span class="correctanswer">
			 {% else %}
			 <span class="incorrectanswer" %>
			 {% endif %}
		       <span class="answer-inner">{{answer.label}}</span></span></li>
		     {% endfor %}
		   </ol>

<p>{{question.explanation|markdown}}</p>
                 </div>
           </div>
	   {% endif %}
	   {% endif %}
	   {% else %}
	   {% comment %} short/long text questions {% endcomment %}

	   {% if block.rhetorical %}
	   {% if question.explanation %}
           <div class="casesanswerdisplay">
                 <a href="#q{{question.id}}" class="moretoggle">Show explanation &gt;&gt;</a>
                 <div id="q{{question.id}}" class="toggleable">
                 <p>{{question.explanation|markdown}}</p>
                 </div>
           </div>
	   {% endif %}
	   {% endif %}

	   {% endif %}
     </div>
</div> 
{% endfor %}

{% endif %}{% endif %}
